# all websites we will use their data
weather_websites:
  - source: SoDa
    url: https://soda.dit.uop.gr/
    code: soda
    spider_name: soda_live_data

  - source: WeatherUnderground
    url: https://www.wunderground.com/
    code: wu
    spider_name: wu_live_data

  - source: Meteo
    url: https://meteo.gr/
    code: meteo
    spider_name: meteo_live_data

  - source: OpenMeteo
    url: https://open-meteo.com/
    code: openmeteo
    spider_name: open-meteo_live_data

  - source: OpenWeatherMap
    url: https://open-meteo.com/
    code: openweathermap
    spider_name: open-weather-map_live_data

check_station_availability: True # checks if station is offline or online
get_weather_basic_data: True # if True, include items from 'weather_live_basic_data' in the scraping process
get_weather_measurements: True # if True, include items from 'weather_live_conditions_measurements' in the scraping process

# defines the basic fields collected for each weather record
weather_live_basic_data:
  - farm
  - source
  - timedata
  - crawled
  - city
  - nomos
  # - station_number

# defines the measurements fields collected for each weather record from all websites
# comment to remove or uncomment to add measurement
weather_live_conditions_measurements:
  temperature: [temperature, temperature_2m, temp, Temperatura aria, 9]
  humidity: [humidity, relative_humidity_2m, Umidità aria, 10]
  wind: [wind, wind_speed, speed, wind_speed_10m, Velocità vento, 8]
  direction: [wind_direction, direction, wind_direction_10m, deg, Direzione vento, 3]
  yetos: [yetos, rainfall, today's rain, today's_rain, rain, Pioggia, 11]
  barometer: [pressure, barometer, surface_pressure, Pressione atmosferica, 2]
  dew_point: [dew_point, dew point, Punto di rugiada, 15]
  heat_index: [heat_index, heat index]
  wind_chill: [wind_chill, wind chill]
  solar_radiation: [solar_radiation, solar radiation, Radiazione solare, 7]

results_units:
  temperature: c # C = celsius
  humidity: '%' # 
  wind: km/h #
  direction: null
  yetos: mm #
  barometer: hpa #
  dew_point: c
  heat_index: c #
  wind_chill: c
  solar_radiation: w/m², w/m^2

# farms information
# each station must include 'url', 'source', and 'city' fields
farms:
  farm1: # Tegea, Arkadia, Greece

    - url: SODA_FARM1_STATION1
      city: Λίμνη Τάκα
      nomos: Αρκαδίας
      code: soda
      source: SoDa
      station_number: 1

    - url: SODA_FARM1_STATION2
      city: Τεγέα
      nomos: Αρκαδίας
      code: soda
      source: SoDa
      station_number: 2
    
    - url: https://www.wunderground.com/weather/IMAGOU3
      city: Μαγούλα
      nomos: Αρκαδίας
      code: wu
      source: WeatherUnderground
      station_number: 4

  farm2: # Paparis, Arkadia, Greece
    
    - url: https://www.wunderground.com/weather/IASSEA3
      city: Πάπαρης
      nomos: Αρκαδίας
      code: wu
      source: WeatherUnderground
      station_number: 1

    - url: https://penteli.meteo.gr/stations/voutsaras/
      city: Βουτσαράς
      nomos: Αρκαδίας
      code: meteo
      source: Meteo
      station_number: 2

    - url: OPEN_METEO_FARM2
      city: Πάπαρης
      nomos: Αρκαδίας
      code: openmeteo
      source: OpenMeteo
      station_number: 3

    # - url: OPEN_WEATHER_MAP_FARM2
    #   city: Πάπαρης
    #   nomos: Αρκαδίας
    #   code: openweathermap
    #   source: OpenWeatherMap
    #   station_number: 4

  farm3: # Agricultural University, Athens, Greece

    - url: https://penteli.meteo.gr/stations/athens/
      city: Γκάζι
      nomos: Αττικής
      code: meteo
      source: Meteo
      station_number: 1

    - url: https://www.wunderground.com/weather/IATHEN112
      city: Πετράλωνα
      nomos: Αττικής
      code: wu
      source: WeatherUnderground
      station_number: 2

    - url: https://penteli.meteo.gr/stations/peristeri/
      city: Περιστέρι
      nomos: Αττικής
      code: meteo
      source: Meteo
      station_number: 3

    # - url: https://www.wunderground.com/weather/IAEGAL9
    #   city: Αιγάλεω
    #   nomos: Αττικής
    #   code: wu
    #   source: WeatherUnderground
    #   station_number: 4
  
  farm4:

    - url: https://penteli.meteo.gr/stations/levidi/
      city: Λεβίδι
      nomos: Αρκαδίας
      code: meteo
      source: Meteo
      station_number: 1

    - url: SODA_FARM4_STATION2
      city: Κάψια
      nomos: Αρκαδίας
      code: soda
      source: SoDa
      station_number: 2

    - url: https://www.wunderground.com/weather/gr/kapsas/IKAPSA2
      city: Κάψια
      nomos: Αρκαδίας
      code: wu
      source: WeatherUnderground
      station_number: 3


# all paths used for extracting specific information from the meteo website (extracted from the website HTML)
meteo_live_data_paths:
  station_availability: //div[contains(@class, "offline boxshadow")]/span/text()
  get_day_and_hour: .//div[contains(@class, "headline gradient")]/span[2]/text()
  get_data_table: //div[@class="col_sub dist boxshadow realtime"]//div[@class="line"] # table = data from meteo
  get_data_table_label: .//div[@class="lleft"]/span[1]/text()
  get_data_table_value: .//div[@class="lright"]/span/text()

# all paths used for extracting specific information from the weather-underground website (extracted from the website HTML)
weather-underground_live_data_paths:
  station_availability: //div[@class="dashboard__title"]/div/span[1]/text()
  get_last_updated: //div[@class="dashboard__title"]/div/span[2]/text()
  get_day_and_hour: .//p[@class="timestamp"]/span[1]/strong/text()

  temperature:
    value: './/span[contains(@class,"test-true wu-unit wu-unit-temperature is-degree-visible")]/span/text()'
    unit: './/span[contains(@class,"test-true wu-unit wu-unit-temperature is-degree-visible")]/span[@class="wu-label"]/span[2]/text()'
  
  humidity:
    value: './/span[contains(@class,"test-false wu-unit wu-unit-humidity")]/span/text()'
    unit: './/span[@class="test-false wu-unit wu-unit-humidity"]/span[@class="wu-label"]/span[2]/text()'

  wind:
    value: './/header[@class="wind-speed"]/strong/text()'
    unit: './/span[@class="test-false wu-unit wu-unit-speed"]/span[@class="wu-label"]/span[2]/text()'

  direction:
    value: './/div[contains(@class,"wind-compass")]/@style'
    unit: null

  yetos:
    value: './/span[contains(@class,"test-false wu-unit wu-unit-rain")]/span/text()'
    unit: './/span[contains(@class,"test-false wu-unit wu-unit-rain")]/span[@class="wu-label"]/span[2]/text()'

  barometer:
    value: './/span[contains(@class,"test-false wu-unit wu-unit-pressure")]/span/text()'
    unit: './/span[contains(@class,"test-false wu-unit wu-unit-pressure")]/span[@class="wu-label"]/span[2]/text()'

  dew_point:
    value: './/span[@class="test-false wu-unit wu-unit-temperature"]/span/text()'
    unit: './/span[@class="test-false wu-unit wu-unit-temperature"]/span[@class="wu-label"]/span[2]/text()'

soda_api_paths:
  weather_sensor_id_path: [17]

preprocessing:
  meteo:
    staging: data/meteo/staging.csv
    raw: data/meteo/raw
    cleaned: data/meteo/cleaned
    failed: data/meteo/failed
    
  wu:
    staging: data/wu/staging.csv
    raw: data/wu/raw
    cleaned: data/wu/cleaned
    failed: data/wu/failed

  soda:
    staging: data/soda/staging.csv
    raw: data/soda/raw
    cleaned: data/soda/cleaned
    failed: data/soda/failed

  open-meteo:
    staging: data/open-meteo/staging.csv
    raw: data/open-meteo/raw
    cleaned: data/open-meteo/cleaned
    failed: data/open-meteo/failed

  # open-weather-map:
  #   staging: data/open-weather-map/staging.csv
  #   raw: data/open-weather-map/raw
  #   cleaned: data/open-weather-map/cleaned
  #   failed: data/open-weather-map/failed

commands: # .../PROVATO$
  meteo: scrapy crawl meteo_live_data -o data/meteo/staging.csv
  wu: scrapy crawl wu_live_data -o data/wu/staging.csv
  soda: python3 -m apis.soda_live_data
  openmeteo: python3 -m apis.open-meteo_live_data
  # openweathermap: python3 -m apis.open-weather-map_live_data

  preprocessing: python3 preprocessing/preprocessing.py